package us.bridgeses.Minder;

import android.content.Intent;
import android.content.pm.PackageInfo;
import android.content.pm.PackageManager;
import android.net.Uri;
import android.os.Bundle;
import android.preference.Preference;
import android.preference.PreferenceFragment;
import android.util.Log;

/**
 * Created by Tony on 1/30/2015.
 */
public class AboutFragment extends PreferenceFragment implements Preference.OnPreferenceClickListener {


	public static AboutFragment ewInstance() {
		AboutFragment fragment = new AboutFragment();
		return fragment;
	}

	@Override
	public boolean onPreferenceClick(Preference preference) {
		String key = preference.getKey();
		if (key.equals("support")){
			String url = "http://support.bridgeses.us";
			Intent i = new Intent(Intent.ACTION_VIEW);
			i.setData(Uri.parse(url));
			startActivity(i);
		}
		if (key.equals("icon_attribution")){
			String url = "https://www.etsy.com/shop/TravelingMonsterShop";
			Intent i = new Intent(Intent.ACTION_VIEW);
			i.setData(Uri.parse(url));
			startActivity(i);
		}
		return false;
	}

	public void onCreate(Bundle savedInstanceState){
		super.onCreate(savedInstanceState);
		addPreferencesFromResource(R.xml.about_preference);
		super.findPreference("website").setOnPreferenceClickListener(this);
		super.findPreference("support").setOnPreferenceClickListener(this);
		super.findPreference("feedback").setOnPreferenceClickListener(this);
		super.findPreference("icon_attribution").setOnPreferenceClickListener(this);
		try {
			PackageInfo pInfo = getActivity().getPackageManager().getPackageInfo(getActivity().getPackageName(), 0);
			String version = pInfo.versionName;
			super.findPreference("version").setSummary(version);
		}
		catch(PackageManager.NameNotFoundException e){
			Log.e("Minder", "Package name not found");
		}
	}
}
